<div class="attendance-container">



  <!-- Attendance Table -->
  <div class="container card fade-in">

    <div style="margin-block: 10px;" class=" mb-3">
    <h2>Attendance Management</h2>
    
  </div>

      <div class="row gap-3">
    <!-- Clock Card -->
    <div style="flex: 1;margin-bottom: var(--space-4);" class="">
      <div class="clock-section">
        <div class="clock-display">
          <div class="current-time">{{ currentTime }}</div>
          <div class="clock-status" [class]="clockStatus">
            {{ clockStatus === 'clocked-in' ? 'Clocked In' : 'Clocked Out' }}
          </div>
        </div>
        <div class="clock-actions">
          <button 
            class="btn clock-btn" 
            [class.btn-success]="clockStatus === 'clocked-out'"
            [class.btn-error]="clockStatus === 'clocked-in'"
            (click)="toggleClock()"
          >
            {{ clockStatus === 'clocked-out' ? 'Clock In' : 'Clock Out' }}
          </button>
          <div class="work-hours" *ngIf="clockStatus === 'clocked-in'">
            Working: {{ workingHours }}
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Card -->
    <div class="" style="flex: 1;">
      <div class="card filter-section">
        <h3 class="mb-3">Filter Attendance</h3>
        <form (ngSubmit)="applyFilter()">
          <div class="form-group">
            <label class="form-label">Start Date</label>
            <input 
              type="date" 
              class="form-control" 
              [(ngModel)]="startDate" 
              name="startDate"
              required>
          </div>
          <div class="form-group">
            <label class="form-label">End Date</label>
            <input 
              type="date" 
              class="form-control" 
              [(ngModel)]="endDate" 
              name="endDate"
              required>
          </div>
          <button type="submit" class="btn btn-primary mt-3">Apply</button>
        </form>
      </div>
    </div>
  </div>

    <!-- <h2 class="mb-4">Attendance Records</h2> -->

    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Clock In</th>
            <th>Clock Out</th>
            <th>Effective Hours</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let rec of records"
              [ngClass]="{
                'bg-neutral-100': isWeekend(rec.attendanceDate),
                'bg-primary-light': isToday(rec.attendanceDate),
                'bg-white': !isWeekend(rec.attendanceDate) && !isToday(rec.attendanceDate)
              }">
            <td>{{ rec.attendanceDate }}</td>
            <td>
              {{ formatTime(rec.clockInTime) }}
              <span *ngIf="rec.active" class="badge badge-success ml-2">Active</span>
            </td>
            <td>{{ formatTime(rec.clockOutTime) }}</td>
            <td>{{ rec.effectiveHours }}</td>
            <td>
              <ng-container *ngIf="isWeekend(rec.attendanceDate)">
                <span class="badge badge-accent">Off Day</span>
              </ng-container>
              <ng-container *ngIf="!isWeekend(rec.attendanceDate)">
                <ng-container *ngIf="rec.isManualOut === null">-</ng-container>
                <ng-container *ngIf="rec.isManualOut === true">
                  <span class="badge badge-success">Manual</span>
                </ng-container>
                <ng-container *ngIf="rec.isManualOut === false">
                  <span class="badge badge-error d-flex align-items-center gap-2">
                    <span class="material-icons" style="font-size:16px;">warning</span>
                    System
                  </span>
                </ng-container>
              </ng-container>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
